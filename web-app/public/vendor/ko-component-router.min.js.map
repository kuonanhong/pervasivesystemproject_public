{"version":3,"sources":["ko-component-router.js"],"names":["global","factory","exports","module","require","define","amd","ko","router","this","isObjectObject","o","isObject","Object","prototype","toString","call","isArray","arr","splice","isBool","x","isPlainObject","index","isString","isFunction","isUndefined","flatMap","fn","reduce","flattened","v","concat","runMiddleware","callbacks","this$1","args","len","arguments","length","downstream","map","runner","generatorify","apply","run","Promise","$return","$error","ret","next","isThenable","then","value","bind","$await_18","$boundEx","push","sequence","$Loop_9","$iterator_fn_8","done","_fn","promisify","$await_19","$Loop_9_exit","$Loop_9_trampoline","Symbol","iterator","q","pop","_exception","isGenerator","constructor","name","count","$await_20","beforeRender","$If_13","$logicalAnd_1","afterRender","$await_23","$If_14","$logicalAnd_2","beforeDispose","$await_25","$If_15","$logicalAnd_3","afterDispose","$await_27","r","parse","str","options","res","tokens","key","path","defaultDelimiter","delimiter","PATH_REGEXP","exec","m","escaped","offset","slice","prefix","capture","group","modifier","asterisk","partial","repeat","optional","pattern","escapeGroup","escapeString","substr","compile","tokensToFunction","encodeURIComponentPretty","encodeURI","replace","c","charCodeAt","toUpperCase","encodeAsterisk","matches","Array","i","RegExp","obj","opts","data","encode","pretty","encodeURIComponent","token","segment","TypeError","isarray","JSON","stringify","j","test","attachKeys","re","keys","flags","sensitive","regexpToRegexp","groups","source","match","arrayToRegexp","parts","pathToRegexp","regexp","join","stringToRegexp","tokensToRegExp","strict","end","route","endsWithDelimiter","resolveHref","bindingCtx","_path","ref","parsePathBinding","base","isActivePath","isNavigating","ctx","pathname","split","getRouter","indexOf","isRoot","$parent","$child","$router","$parentContext","Router$1","get","unwrapParams","params","unwrapParam","p","isObservable","console","warn","unwrap","index$1","val","ctor","prot","hasOwnProperty","Context","assign","fullPath","canonicalPath","$root","_queue","_beforeNavigateCallbacks","_afterRenderCallbacks","_beforeDisposeCallbacks","_afterDisposeCallbacks","prototypeAccessors$1","$parents","$children","element","addBeforeNavigateCallback","cb","unshift","undefined","document","getElementsByClassName","depth","runBeforeNavigateCallbacks","queue","promise","flushQueue","all","runBeforeRender","appBeforeRender","appDownstream","routeBeforeRender","routeDownstream","middleware","$await_3","$await_4","$await_5","runAfterRender","$await_6","$await_7","runBeforeDispose","$If_1","$await_9","$await_10","$await_8","runAfterDispose","$await_11","$await_12","defineProperties","index$4","index$3","parse_1","compile_1","tokensToFunction_1","tokensToRegExp_1","Route","pluginMiddleware","plugins","ms","_m","component","children","entries","_keys","_regexp","list","childRoute","childPath","k","createRoutes","routes","events","click","ontouchstart","popstate","onInit","routers","Router","observable","link","setConfig","addEventListener","onclick","window","onpopstate","ref$1","passthrough","accum","update","getPathFromLocation","forEach","prototypeAccessors","staticAccessors","head","tail","initialized","config","hashbang","reverse","url","$If_2","$If_3","fromCtxChildren","fromCtx","toCtx","$Loop_6","$iterator_fromCtxChild_5","fromCtxChild","$await_13","$Loop_6_exit","$await_14","$If_4","$await_15","tasks","runEarly","$Loop_6_trampoline","history","state","title","search","hash","shouldNavigate","parseUrl","getPath","resolveRoute","assign$1","force","matchingRouteWithFewestDynamicSegments","fewestMatchingSegments","Infinity","rn","location","baseWithOrWithoutHashbangRegexp","dispose","unlink","removeEventListener","use","fns","usePlugin","useRoutes","resolve","e","defaultPrevented","el","target","nodeName","parentNode","isValidRoute","hasRoute","isCrossOrigin","sameOrigin","href","isDoubleClick","which","isDownload","hasAttribute","isEmptyHash","getAttribute","isMailto","hasExternalRel","hasModifier","metaKey","ctrlKey","shiftKey","hasOtherTarget","preventDefault","canonicalizePath","parser","createElement","b","toLowerCase","charAt","hostname","port","protocol","origin","event","button","bindingHandlers","init","valueAccessor","allBindings","viewModel","schedule","applyBindingsToNode","attr","pureComputed","css","active-path","components","register","synchronous","createViewModel","template","__ko_component_router__","$rawData","extend","controlsDescendantBindings"],"mappings":"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","file":"ko-component-router.min.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('knockout')) :\n\ttypeof define === 'function' && define.amd ? define('ko-component-router', ['knockout'], factory) :\n\t(global.ko = global.ko || {}, global.ko.router = factory(global.ko));\n}(this, (function (ko) { 'use strict';\n\nko = 'default' in ko ? ko['default'] : ko;\n\n/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2015, Jon Schlinkert.\n * Licensed under the MIT License.\n */\n\nvar index$1 = function isObject(val) {\n  return val != null && typeof val === 'object'\n    && !Array.isArray(val);\n};\n\nvar isObject = index$1;\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nvar index = function isPlainObject(o) {\n  var ctor,prot;\n  \n  if (isObjectObject(o) === false) return false;\n  \n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n  \n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n  \n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n  \n  // Most likely a plain Object\n  return true;\n};\n\nfunction isArray(arr) {\n    return typeof arr.splice === 'function';\n}\n\nfunction isBool(x) {\n    return typeof x === 'boolean';\n}\n\nfunction isPlainObject(x) {\n    return index(x);\n}\n\nfunction isString(x) {\n    return typeof x === 'string';\n}\n\nfunction isFunction(x) {\n    return typeof x === 'function';\n}\n\nfunction isUndefined(x) {\n    return typeof x === 'undefined';\n}\n\nfunction flatMap(arr, fn) {\n    return arr.reduce(function (flattened, x) {\n        var v = fn(x);\n        return flattened.concat(isArray(v) ? v : [v]);\n    }, []);\n}\n\nfunction runMiddleware(callbacks) {\n    var this$1 = this;\n    var args = [], len = arguments.length - 1;\n    while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n    var downstream = [];\n    callbacks = callbacks.map(function (fn) {\n        var runner = generatorify(fn).apply(void 0, args);\n        var run = function () { return new Promise((function ($return, $error) {\n            var ret;\n            ret = runner.next();\n            return new Promise((function ($return, $error) {\n                if (isThenable(ret)) {\n                    return ret.then($return, $error);\n                }\n                return $return(ret.value);\n            }).bind(this)).then((function ($await_18) {\n                try {\n                    ret = $await_18;\n                    return $return(ret || true);\n                } catch ($boundEx) {\n                    return $error($boundEx);\n                }\n            }).bind(this), $error);\n        }).bind(this$1)); };\n        downstream.push(run);\n        return run;\n    });\n    return [sequence.apply(void 0, [ callbacks ].concat( args )),function () { return sequence.apply(void 0, [ downstream ].concat( args )); }];\n}\n\nfunction sequence(callbacks) {\n    var args = [], len = arguments.length - 1;\n    while ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n    return new Promise((function ($return, $error) {\n        {\n            var _fn, $iterator_fn_8 = [callbacks[Symbol.iterator]()];\n            var $Loop_9_trampoline;\n            return ($Loop_9_trampoline = (function (q) {\n                var this$1 = this;\n\n                while (q) {\n                    if (q.then) \n                        { return void q.then($Loop_9_trampoline, $error); }\n                    try {\n                        if (q.pop) \n                            { if (q.length) \n                            { return q.pop() ? $Loop_9_exit.call(this$1) : q; }\n                         else \n                            { q = $Loop_9; } }\n                         else \n                            { q = q.call(this$1); }\n                    } catch (_exception) {\n                        return $error(_exception);\n                    }\n                }\n            }).bind(this))($Loop_9);\n            function $Loop_9() {\n                if (!($iterator_fn_8[1] = $iterator_fn_8[0].next()).done && ((_fn = $iterator_fn_8[1].value) || true)) {\n                    return promisify(_fn).apply(void 0, args).then((function ($await_19) {\n                        try {\n                            if ($await_19 === false) {\n                                return $return(false);\n                            }\n                            return $Loop_9;\n                        } catch ($boundEx) {\n                            return $error($boundEx);\n                        }\n                    }).bind(this), $error);\n                } else \n                    { return [1]; }\n            }\n            \n        }\n        function $Loop_9_exit() {\n            return $return();\n        }\n        \n    }).bind(this));\n}\n\nfunction isGenerator(x) {\n    return x.constructor.name === 'GeneratorFunction';\n}\n\nfunction isThenable(x) {\n    return !isUndefined(x) && isFunction(x.then);\n}\n\nfunction generatorify(fn) {\n    return isGenerator(fn) ? fn : function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var count = 1, ret;\n        return {\n            next: function next() {\n                return new Promise((function ($return, $error) {\n                    switch (count++) {\n                        case 1:\n                            return promisify(fn).apply(void 0, args).then((function ($await_20) {\n                                try {\n                                    ret = $await_20 || false;\n                                    return new Promise((function ($return, $error) {\n                                        if (ret && ret.beforeRender) {\n                                            return promisify(ret.beforeRender)().then($return, $error);\n                                        }\n                                        return $return(ret);\n                                    }).bind(this)).then($return, $error);\n                                } catch ($boundEx) {\n                                    return $error($boundEx);\n                                }\n                            }).bind(this), $error);\n                        case 2:\n                            return new Promise((function ($return, $error) {\n                                var $logicalAnd_1;\n                                if ($logicalAnd_1 = ret) {\n                                    return promisify(ret.afterRender)().then((function ($await_23) {\n                                        try {\n                                            $logicalAnd_1 = $await_23;\n                                            return $If_13.call(this);\n                                        } catch ($boundEx) {\n                                            return $error($boundEx);\n                                        }\n                                    }).bind(this), $error);\n                                }\n                                function $If_13() {\n                                    return $return($logicalAnd_1);\n                                }\n                                \n                                return $If_13.call(this);\n                            }).bind(this)).then($return, $error);\n                        case 3:\n                            return new Promise((function ($return, $error) {\n                                var $logicalAnd_2;\n                                if ($logicalAnd_2 = ret) {\n                                    return promisify(ret.beforeDispose)().then((function ($await_25) {\n                                        try {\n                                            $logicalAnd_2 = $await_25;\n                                            return $If_14.call(this);\n                                        } catch ($boundEx) {\n                                            return $error($boundEx);\n                                        }\n                                    }).bind(this), $error);\n                                }\n                                function $If_14() {\n                                    return $return($logicalAnd_2);\n                                }\n                                \n                                return $If_14.call(this);\n                            }).bind(this)).then($return, $error);\n                        case 4:\n                            return new Promise((function ($return, $error) {\n                                var $logicalAnd_3;\n                                if ($logicalAnd_3 = ret) {\n                                    return promisify(ret.afterDispose)().then((function ($await_27) {\n                                        try {\n                                            $logicalAnd_3 = $await_27;\n                                            return $If_15.call(this);\n                                        } catch ($boundEx) {\n                                            return $error($boundEx);\n                                        }\n                                    }).bind(this), $error);\n                                }\n                                function $If_15() {\n                                    return $return($logicalAnd_3);\n                                }\n                                \n                                return $If_15.call(this);\n                            }).bind(this)).then($return, $error);\n                    }\n                    return $return();\n                }).bind(this));\n            }\n        };\n    };\n}\n\nfunction promisify(_fn) {\n    var this$1 = this;\n    if ( _fn === void 0 ) _fn = function () {};\n\n    return function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new Promise((function ($return, $error) {\n        var fn, ret;\n        fn = (function () { return _fn.length === args.length + 1 ? new Promise(function (r) {\n            _fn.apply(void 0, args.concat( [r] ));\n        }) : _fn.apply(void 0, args); });\n        ret = fn();\n        return new Promise((function ($return, $error) {\n            if (isThenable(ret)) {\n                return ret.then($return, $error);\n            }\n            return $return(ret);\n        }).bind(this)).then($return, $error);\n    }).bind(this$1));\n    };\n}\n\nvar Context = function Context(params) {\n    Object.assign(this, params);\n    this.fullPath = this.router.base + this.pathname;\n    this.canonicalPath = this.fullPath.replace(new RegExp(this.router.$root.base, 'i'), '');\n    this._queue = [];\n    this._beforeNavigateCallbacks = [];\n    this._afterRenderCallbacks = [];\n    this._beforeDisposeCallbacks = [];\n    this._afterDisposeCallbacks = [];\n};\n\nvar prototypeAccessors$1 = { $parent: {},$parents: {},$child: {},$children: {},element: {} };\nContext.prototype.addBeforeNavigateCallback = function addBeforeNavigateCallback (cb) {\n    this._beforeNavigateCallbacks.unshift(cb);\n};\nprototypeAccessors$1.$parent.get = function () {\n    return this.router.isRoot ? undefined : this.router.$parent.ctx;\n};\nprototypeAccessors$1.$parents.get = function () {\n    return this.router.$parents.map(function (r) { return r.ctx; });\n};\nprototypeAccessors$1.$child.get = function () {\n    return isUndefined(this.router.$child) ? undefined : this.router.$child.ctx;\n};\nprototypeAccessors$1.$children.get = function () {\n    return this.router.$children.map(function (r) { return r.ctx; });\n};\nprototypeAccessors$1.element.get = function () {\n    return document.getElementsByClassName('ko-component-router-view')[this.router.depth];\n};\nContext.prototype.runBeforeNavigateCallbacks = function runBeforeNavigateCallbacks () {\n    return new Promise((function ($return, $error) {\n        var ctx, callbacks;\n        ctx = this;\n        callbacks = [];\n        while (ctx) {\n            callbacks = ctx._beforeNavigateCallbacks.concat( callbacks);\n            ctx = ctx.$child;\n        }\n        return sequence(callbacks).then($return, $error);\n    }).bind(this));\n};\nContext.prototype.queue = function queue (promise) {\n    this._queue.push(promise);\n};\nContext.prototype.flushQueue = function flushQueue () {\n    return new Promise((function ($return, $error) {\n            var this$1 = this;\n\n        return $return(Promise.all(this._queue).then(function () { return this$1._queue = []; }));\n    }).bind(this));\n};\nContext.prototype.runBeforeRender = function runBeforeRender () {\n    return new Promise((function ($return, $error) {\n        var appBeforeRender, appDownstream, routeBeforeRender, routeDownstream;\n        var assign;\n            (assign = runMiddleware(Router$1.middleware, this), appBeforeRender = assign[0], appDownstream = assign[1]);\n        this._afterRenderCallbacks.push(appDownstream);\n        this._beforeDisposeCallbacks.push(appDownstream);\n        this._afterDisposeCallbacks.push(appDownstream);\n        return appBeforeRender.then((function ($await_3) {\n            try {\n                var assign;\n                    (assign = runMiddleware(this.route.middleware, this), routeBeforeRender = assign[0], routeDownstream = assign[1]);\n                this._afterRenderCallbacks.push(routeDownstream);\n                this._beforeDisposeCallbacks.unshift(routeDownstream);\n                this._afterDisposeCallbacks.unshift(routeDownstream);\n                return routeBeforeRender.then((function ($await_4) {\n                    try {\n                        return this.flushQueue().then((function ($await_5) {\n                            try {\n                                return $return();\n                            } catch ($boundEx) {\n                                return $error($boundEx);\n                            }\n                        }).bind(this), $error);\n                    } catch ($boundEx) {\n                        return $error($boundEx);\n                    }\n                }).bind(this), $error);\n            } catch ($boundEx) {\n                return $error($boundEx);\n            }\n        }).bind(this), $error);\n    }).bind(this));\n};\nContext.prototype.runAfterRender = function runAfterRender () {\n    return new Promise((function ($return, $error) {\n        return sequence(this._afterRenderCallbacks).then((function ($await_6) {\n            try {\n                return this.flushQueue().then((function ($await_7) {\n                    try {\n                        return $return();\n                    } catch ($boundEx) {\n                        return $error($boundEx);\n                    }\n                }).bind(this), $error);\n            } catch ($boundEx) {\n                return $error($boundEx);\n            }\n        }).bind(this), $error);\n    }).bind(this));\n};\nContext.prototype.runBeforeDispose = function runBeforeDispose () {\n    return new Promise((function ($return, $error) {\n        if (this.$child) {\n            return this.$child.runBeforeDispose().then((function ($await_8) {\n                try {\n                    return $If_1.call(this);\n                } catch ($boundEx) {\n                    return $error($boundEx);\n                }\n            }).bind(this), $error);\n        }\n        function $If_1() {\n            return sequence(this._beforeDisposeCallbacks).then((function ($await_9) {\n                try {\n                    return this.flushQueue().then((function ($await_10) {\n                        try {\n                            return $return();\n                        } catch ($boundEx) {\n                            return $error($boundEx);\n                        }\n                    }).bind(this), $error);\n                } catch ($boundEx) {\n                    return $error($boundEx);\n                }\n            }).bind(this), $error);\n        }\n            \n        return $If_1.call(this);\n    }).bind(this));\n};\nContext.prototype.runAfterDispose = function runAfterDispose () {\n    return new Promise((function ($return, $error) {\n        return sequence(this._afterDisposeCallbacks).then((function ($await_11) {\n            try {\n                return this.flushQueue().then((function ($await_12) {\n                    try {\n                        return $return();\n                    } catch ($boundEx) {\n                        return $error($boundEx);\n                    }\n                }).bind(this), $error);\n            } catch ($boundEx) {\n                return $error($boundEx);\n            }\n        }).bind(this), $error);\n    }).bind(this));\n};\n\nObject.defineProperties( Context.prototype, prototypeAccessors$1 );\n\nvar index$4 = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n\nvar isarray = index$4;\n\n/**\n * Expose `pathToRegexp`.\n */\nvar index$3 = pathToRegexp;\nvar parse_1 = parse;\nvar compile_1 = compile;\nvar tokensToFunction_1 = tokensToFunction;\nvar tokensToRegExp_1 = tokensToRegExp;\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g');\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = [];\n  var key = 0;\n  var index = 0;\n  var path = '';\n  var defaultDelimiter = options && options.delimiter || '/';\n  var res;\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0];\n    var escaped = res[1];\n    var offset = res.index;\n    path += str.slice(index, offset);\n    index = offset + m.length;\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1];\n      continue\n    }\n\n    var next = str[index];\n    var prefix = res[2];\n    var name = res[3];\n    var capture = res[4];\n    var group = res[5];\n    var modifier = res[6];\n    var asterisk = res[7];\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path);\n      path = '';\n    }\n\n    var partial = prefix != null && next != null && next !== prefix;\n    var repeat = modifier === '+' || modifier === '*';\n    var optional = modifier === '?' || modifier === '*';\n    var delimiter = res[2] || defaultDelimiter;\n    var pattern = capture || group;\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      asterisk: !!asterisk,\n      pattern: pattern ? escapeGroup(pattern) : (asterisk ? '.*' : '[^' + escapeString(delimiter) + ']+?')\n    });\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index);\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path);\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options))\n}\n\n/**\n * Prettier encoding of URI path segments.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeURIComponentPretty (str) {\n  return encodeURI(str).replace(/[\\/?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Encode the asterisk parameter. Similar to `pretty`, but allows slashes.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeAsterisk (str) {\n  return encodeURI(str).replace(/[?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length);\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$');\n    }\n  }\n\n  return function (obj, opts) {\n    var path = '';\n    var data = obj || {};\n    var options = opts || {};\n    var encode = options.pretty ? encodeURIComponentPretty : encodeURIComponent;\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i];\n\n      if (typeof token === 'string') {\n        path += token;\n\n        continue\n      }\n\n      var value = data[token.name];\n      var segment;\n\n      if (value == null) {\n        if (token.optional) {\n          // Prepend partial segment prefixes.\n          if (token.partial) {\n            path += token.prefix;\n          }\n\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received `' + JSON.stringify(value) + '`')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j]);\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received `' + JSON.stringify(segment) + '`')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment;\n        }\n\n        continue\n      }\n\n      segment = token.asterisk ? encodeAsterisk(value) : encode(value);\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment;\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {!RegExp} re\n * @param  {Array}   keys\n * @return {!RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys;\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {!Array}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g);\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        asterisk: false,\n        pattern: null\n      });\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array}   keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = [];\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source);\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options));\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {!Array}  keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}          tokens\n * @param  {(Array|Object)=} keys\n * @param  {Object=}         options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options);\n    keys = [];\n  }\n\n  options = options || {};\n\n  var strict = options.strict;\n  var end = options.end !== false;\n  var route = '';\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (typeof token === 'string') {\n      route += escapeString(token);\n    } else {\n      var prefix = escapeString(token.prefix);\n      var capture = '(?:' + token.pattern + ')';\n\n      keys.push(token);\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*';\n      }\n\n      if (token.optional) {\n        if (!token.partial) {\n          capture = '(?:' + prefix + '(' + capture + '))?';\n        } else {\n          capture = prefix + '(' + capture + ')?';\n        }\n      } else {\n        capture = prefix + '(' + capture + ')';\n      }\n\n      route += capture;\n    }\n  }\n\n  var delimiter = escapeString(options.delimiter || '/');\n  var endsWithDelimiter = route.slice(-delimiter.length) === delimiter;\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithDelimiter ? route.slice(0, -delimiter.length) : route) + '(?:' + delimiter + '(?=$))?';\n  }\n\n  if (end) {\n    route += '$';\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithDelimiter ? '' : '(?=' + delimiter + '|$)';\n  }\n\n  return attachKeys(new RegExp('^' + route, flags(options)), keys)\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {(Array|Object)=}       keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options);\n    keys = [];\n  }\n\n  options = options || {};\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, /** @type {!Array} */ (keys))\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), /** @type {!Array} */ (keys), options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), /** @type {!Array} */ (keys), options)\n}\n\nindex$3.parse = parse_1;\nindex$3.compile = compile_1;\nindex$3.tokensToFunction = tokensToFunction_1;\nindex$3.tokensToRegExp = tokensToRegExp_1;\n\nvar Route = function Route(path, middleware) {\n    var this$1 = this;\n\n    this.middleware = flatMap(isArray(middleware) ? middleware : [middleware], function (m) {\n        var pluginMiddleware = Router$1.plugins.reduce(function (ms, p) {\n            var _m = p(m);\n            return _m ? ms.concat(isArray(_m) ? _m : [_m]) : ms;\n        }, []);\n        return pluginMiddleware.length > 0 ? pluginMiddleware : m;\n    }).reduce(function (ms, m) {\n        if (isString(m)) {\n            this$1.component = m;\n        } else if (isPlainObject(m)) {\n            path = path.replace(/\\/?!?$/, '/!');\n            this$1.children = Object.entries(m).map(function (ref) {\n                var r = ref[0];\n                var m = ref[1];\n\n                return new Route(r, m);\n            });\n            if (!this$1.component) {\n                this$1.component = 'ko-component-router';\n            }\n        } else if (isFunction(m)) {\n            ms.push(m);\n        }\n        return ms;\n    }, []);\n    if (path[path.length - 1] === '!') {\n        path = path.replace('!', ':__child_path__(.*)?');\n    } else {\n        path = path.replace(/\\(?\\*\\)?/, '(.*)');\n    }\n    this.path = path;\n    this._keys = [];\n    this._regexp = index$3(path, this._keys);\n};\nRoute.prototype.matches = function matches (path) {\n        var this$1 = this;\n\n    var matches = this._regexp.exec(path);\n    if (matches === null) {\n        return false;\n    }\n    if (this.children) {\n        for (var i = 0, list = this$1.children; i < list.length; i += 1) {\n            var childRoute = list[i];\n\n                var childPath = '/' + (matches[matches.length - 1] || '');\n            if (childRoute.matches(childPath)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    return true;\n};\nRoute.prototype.parse = function parse$$1 (path) {\n        var this$1 = this;\n\n    var childPath;\n    var params = {};\n    var matches = this._regexp.exec(path);\n    for (var i = 1, len = matches.length;i < len; ++i) {\n        var k = this$1._keys[i - 1];\n        var v = matches[i] || '';\n        if (k.name === '__child_path__') {\n            childPath = '/' + v;\n        } else {\n            params[k.name] = v;\n        }\n    }\n    return [params,path.replace(new RegExp(childPath + '$'), ''),childPath];\n};\nRoute.createRoutes = function createRoutes (routes) {\n    return Object.entries(routes).map(function (ref) {\n            var r = ref[0];\n            var m = ref[1];\n\n            return new Route(r, m);\n        });\n};\n\nvar events = {\n    click: document.ontouchstart ? 'touchstart' : 'click',\n    popstate: 'popstate'\n};\nvar onInit = [];\nvar routers = [];\nvar Router$1 = function Router(params) {\n    var this$1 = this;\n\n    this.component = ko.observable();\n    this.isNavigating = ko.observable(true);\n    this.routes = Route.createRoutes(params.routes || {});\n    Router.link(this);\n    if (this.isRoot) {\n        Router.setConfig(params);\n        (ref = this.routes).push.apply(ref, Route.createRoutes(Router.routes));\n        document.addEventListener(events.click, Router.onclick);\n        window.addEventListener(events.popstate, Router.onpopstate);\n    } else if (this.$parent.ctx.route.children) {\n        (ref$1 = this.routes).push.apply(ref$1, this.$parent.ctx.route.children);\n    }\n    this.passthrough = Object.entries(params).reduce(function (accum, ref) {\n        var k = ref[0];\n        var v = ref[1];\n\n        return k === 'base' || k === 'hashbang' || k === 'routes' ? accum : Object.assign(accum, ( obj = {}, obj[k] = v, obj ))\n        var obj;\n    }, {});\n    this.update(this.getPathFromLocation(), false).then(function () { return onInit.forEach(function (r) { return r(this$1); }); });\n    var ref;\n    var ref$1;\n};\n\nvar prototypeAccessors = { base: {},$parent: {},$parents: {},$child: {},$children: {} };\nvar staticAccessors = { head: {},tail: {},initialized: {} };\nprototypeAccessors.base.get = function () {\n    return this.isRoot ? Router$1.config.base + (Router$1.config.hashbang ? '/#!' : '') : this.$parent.base + this.$parent.ctx.pathname;\n};\nprototypeAccessors.$parent.get = function () {\n    return routers[this.depth - 1];\n};\nprototypeAccessors.$parents.get = function () {\n    return routers.slice(0, this.depth).reverse();\n};\nprototypeAccessors.$child.get = function () {\n    return routers[this.depth + 1];\n};\nprototypeAccessors.$children.get = function () {\n    return routers.slice(this.depth + 1);\n};\nRouter$1.prototype.update = function update (url, args) {\n    return new Promise((function ($return, $error) {\n        var fromCtx, search, hash, path, route, params, pathname, childPath, shouldNavigate, toCtx, fromCtxChildren;\n        fromCtx = this.ctx;\n        if (isBool(args)) {\n            args = {\n                push: args\n            };\n        } else if (isUndefined(args)) {\n            args = {};\n        }\n        if (isUndefined(args.push)) {\n            args.push = true;\n        }\n        if (isUndefined(args.with)) {\n            args.with = {};\n        }\n        var assign;\n            ((assign = Router$1.parseUrl(url), search = assign.search, hash = assign.hash));\n        path = Router$1.getPath(url);\n        route = this.resolveRoute(path);\n        if (!route) {\n            return $return(false);\n        }\n        var assign$1;\n            (assign$1 = route.parse(path), params = assign$1[0], pathname = assign$1[1], childPath = assign$1[2]);\n        if (fromCtx && fromCtx.pathname === pathname && !args.force) {\n            if (this.$child) {\n                return this.$child.update(childPath + search + hash, args).then($return, $error);\n            } else {\n                return $return(false);\n            }\n            return $If_1.call(this);\n        }\n        function $If_1() {\n            if (fromCtx) {\n                return fromCtx.runBeforeNavigateCallbacks().then((function ($await_10) {\n                    try {\n                        shouldNavigate = $await_10;\n                        if (shouldNavigate === false) {\n                            return $return(false);\n                        }\n                        this.isNavigating(true);\n                        return $If_2.call(this);\n                    } catch ($boundEx) {\n                        return $error($boundEx);\n                    }\n                }).bind(this), $error);\n            }\n            function $If_2() {\n                history[args.push ? 'pushState' : 'replaceState'](history.state, document.title, this.base + path + search + hash);\n                toCtx = new Context(Object.assign({}, args.with, this.passthrough, {\n                    router: this,\n                    params: params,\n                    route: route,\n                    path: path,\n                    pathname: pathname\n                }));\n                if (fromCtx) {\n                    return fromCtx.runBeforeDispose().then((function ($await_11) {\n                        try {\n                            return $If_3.call(this);\n                        } catch ($boundEx) {\n                            return $error($boundEx);\n                        }\n                    }).bind(this), $error);\n                }\n                function $If_3() {\n                    fromCtxChildren = fromCtx && fromCtx.$children.reverse();\n                    return toCtx.runBeforeRender().then((function ($await_12) {\n                        try {\n                            this.ctx = toCtx;\n                            this.component(false);\n                            ko.tasks.runEarly();\n                            this.component(this.ctx.route.component);\n                            ko.tasks.runEarly();\n                            if (fromCtx) {\n                                {\n                                    var fromCtxChild, $iterator_fromCtxChild_5 = [fromCtxChildren[Symbol.iterator]()];\n                                    var $Loop_6_trampoline;\n                                    return ($Loop_6_trampoline = (function (q) {\n                                            var this$1 = this;\n\n                                        while (q) {\n                                            if (q.then) \n                                                { return void q.then($Loop_6_trampoline, $error); }\n                                            try {\n                                                if (q.pop) \n                                                    { if (q.length) \n                                                    { return q.pop() ? $Loop_6_exit.call(this$1) : q; }\n                                                 else \n                                                    { q = $Loop_6; } }\n                                                 else \n                                                    { q = q.call(this$1); }\n                                            } catch (_exception) {\n                                                return $error(_exception);\n                                            }\n                                        }\n                                    }).bind(this))($Loop_6);\n                                    function $Loop_6() {\n                                        if (!($iterator_fromCtxChild_5[1] = $iterator_fromCtxChild_5[0].next()).done && ((fromCtxChild = $iterator_fromCtxChild_5[1].value) || true)) {\n                                            return fromCtxChild.runAfterDispose().then((function ($await_13) {\n                                                try {\n                                                    return $Loop_6;\n                                                } catch ($boundEx) {\n                                                    return $error($boundEx);\n                                                }\n                                            }).bind(this), $error);\n                                        } else \n                                            { return [1]; }\n                                    }\n                                        \n                                }\n                                function $Loop_6_exit() {\n                                    return fromCtx.runAfterDispose().then((function ($await_14) {\n                                        try {\n                                            return $If_4.call(this);\n                                        } catch ($boundEx) {\n                                            return $error($boundEx);\n                                        }\n                                    }).bind(this), $error);\n                                }\n                                    \n                            }\n                            function $If_4() {\n                                return toCtx.runAfterRender().then((function ($await_15) {\n                                    try {\n                                        this.isNavigating(false);\n                                        return $return(true);\n                                    } catch ($boundEx) {\n                                        return $error($boundEx);\n                                    }\n                                }).bind(this), $error);\n                            }\n                                \n                            return $If_4.call(this);\n                        } catch ($boundEx) {\n                            return $error($boundEx);\n                        }\n                    }).bind(this), $error);\n                }\n                    \n                return $If_3.call(this);\n            }\n                \n            return $If_2.call(this);\n        }\n            \n        return $If_1.call(this);\n    }).bind(this));\n};\nRouter$1.prototype.resolveRoute = function resolveRoute (path) {\n        var this$1 = this;\n\n    var matchingRouteWithFewestDynamicSegments;\n    var fewestMatchingSegments = Infinity;\n    for (var rn in this$1.routes) {\n        var r = this$1.routes[rn];\n        if (r.matches(path)) {\n            if (r._keys.length === 0) {\n                return r;\n            } else if (fewestMatchingSegments === Infinity || r._keys.length < fewestMatchingSegments && r._keys[0].pattern !== '.*') {\n                fewestMatchingSegments = r._keys.length;\n                matchingRouteWithFewestDynamicSegments = r;\n            }\n        }\n    }\n    return matchingRouteWithFewestDynamicSegments;\n};\nRouter$1.prototype.getPathFromLocation = function getPathFromLocation () {\n    var path = location.pathname + location.search + location.hash;\n    var baseWithOrWithoutHashbangRegexp = this.base.replace('#!', '#?!?');\n    return path.replace(new RegExp(baseWithOrWithoutHashbangRegexp, 'i'), '');\n};\nRouter$1.prototype.dispose = function dispose () {\n        var this$1 = this;\n\n    Router$1.unlink();\n    if (this.isRoot) {\n        document.removeEventListener(events.click, Router$1.onclick, false);\n        window.removeEventListener(events.popstate, Router$1.onpopstate, false);\n        this.ctx.runBeforeDispose().then(function () { return this$1.ctx.runAfterDispose(); });\n    }\n};\nRouter$1.setConfig = function setConfig (ref) {\n        var base = ref.base;\n        var hashbang = ref.hashbang;\n\n    if (base) {\n        Router$1.config.base = base;\n    }\n    if (hashbang) {\n        Router$1.config.hashbang = hashbang;\n    }\n};\nRouter$1.use = function use () {\n        var fns = [], len = arguments.length;\n        while ( len-- ) fns[ len ] = arguments[ len ];\n\n    (ref = Router$1.middleware).push.apply(ref, fns);\n        var ref;\n};\nRouter$1.usePlugin = function usePlugin () {\n        var fns = [], len = arguments.length;\n        while ( len-- ) fns[ len ] = arguments[ len ];\n\n    (ref = Router$1.plugins).push.apply(ref, fns);\n        var ref;\n};\nRouter$1.useRoutes = function useRoutes (routes) {\n    Object.assign(Router$1.routes, routes);\n};\nRouter$1.get = function get (i) {\n    return routers[i];\n};\nstaticAccessors.head.get = function () {\n    return routers[0];\n};\nstaticAccessors.tail.get = function () {\n    return routers[routers.length - 1];\n};\nstaticAccessors.initialized.get = function () {\n    if (routers.length === 0) {\n        return new Promise(function (resolve) { return onInit.push(resolve); });\n    } else {\n        return Promise.resolve(Router$1.head);\n    }\n};\nRouter$1.update = function update () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n    return new Promise((function ($return, $error) {\n        return (ref = routers[0]).update.apply(ref, args).then($return, $error);\n            var ref;\n    }).bind(this));\n};\nRouter$1.link = function link (router) {\n    router.depth = routers.length;\n    router.isRoot = router.depth === 0;\n    routers.push(router);\n    router.$root = routers[0];\n};\nRouter$1.unlink = function unlink () {\n    routers.pop();\n};\nRouter$1.onclick = function onclick (e) {\n    if (e.defaultPrevented) {\n        return;\n    }\n    var el = e.target;\n    while (el && 'A' !== el.nodeName) {\n        el = el.parentNode;\n    }\n    if (!el || 'A' !== el.nodeName) {\n        return;\n    }\n    var pathname = el.pathname;\n        var search = el.search;\n        var hash = el.hash; if ( hash === void 0 ) hash = '';\n    var path = (pathname + search + hash).replace(new RegExp(routers[0].base, 'i'), '');\n    var isValidRoute = Router$1.hasRoute(path);\n    var isCrossOrigin = !Router$1.sameOrigin(el.href);\n    var isDoubleClick = 1 !== Router$1.which(e);\n    var isDownload = el.hasAttribute('download');\n    var isEmptyHash = el.getAttribute('href') === '#';\n    var isMailto = (el.getAttribute('href') || '').indexOf('mailto:') === 0;\n    var hasExternalRel = el.getAttribute('rel') === 'external';\n    var hasModifier = e.metaKey || e.ctrlKey || e.shiftKey;\n    var hasOtherTarget = el.hasAttribute('target');\n    if (!isValidRoute || isCrossOrigin || isDoubleClick || isDownload || isEmptyHash || isMailto || hasExternalRel || hasModifier || hasOtherTarget) {\n        return;\n    }\n    Router$1.update(path);\n    e.preventDefault();\n};\nRouter$1.onpopstate = function onpopstate (e) {\n    Router$1.update(routers[0].getPathFromLocation(), false);\n    e.preventDefault();\n};\nRouter$1.canonicalizePath = function canonicalizePath (path) {\n    return path.replace(new RegExp('/?#?!?/?'), '/');\n};\nRouter$1.parseUrl = function parseUrl (url) {\n    var parser = document.createElement('a');\n    var b = routers[0].base.toLowerCase();\n    if (b && url.toLowerCase().indexOf(b) === 0) {\n        url = url.replace(new RegExp(b, 'i'), '') || '/';\n    }\n    parser.href = Router$1.canonicalizePath(url);\n    return {\n        hash: parser.hash,\n        pathname: parser.pathname.charAt(0) === '/' ? parser.pathname : '/' + parser.pathname,\n        search: parser.search\n    };\n};\nRouter$1.getPath = function getPath (url) {\n    return Router$1.parseUrl(url).pathname;\n};\nRouter$1.hasRoute = function hasRoute (path) {\n    return !isUndefined(Router$1.head.resolveRoute(Router$1.getPath(path)));\n};\nRouter$1.sameOrigin = function sameOrigin (href) {\n    var hostname = location.hostname;\n        var port = location.port;\n        var protocol = location.protocol;\n    var origin = protocol + '//' + hostname;\n    if (port) {\n        origin += ':' + port;\n    }\n    return href && href.indexOf(origin) === 0;\n};\nRouter$1.which = function which (e) {\n    e = e || window.event;\n    return null === e.which ? e.button : e.which;\n};\n\nObject.defineProperties( Router$1.prototype, prototypeAccessors );\nObject.defineProperties( Router$1, staticAccessors );\nRouter$1.config = {\n    base: '',\n    hashbang: false\n};\nRouter$1.middleware = [];\nRouter$1.plugins = [];\nRouter$1.routes = {};\n\nko.bindingHandlers.path = {\n    init: function init(el, valueAccessor, allBindings, viewModel, bindingCtx) {\n        Router$1.initialized.then(function () {\n            ko.tasks.schedule(function () { return ko.applyBindingsToNode(el, {\n                attr: {\n                    href: ko.pureComputed(function () { return resolveHref(bindingCtx, ko.unwrap(valueAccessor())); })\n                },\n                css: {\n                    'active-path': ko.pureComputed(function () { return isActivePath(bindingCtx, ko.unwrap(valueAccessor())); })\n                }\n            }); });\n        });\n    }\n};\nfunction resolveHref(bindingCtx, _path) {\n    var ref = parsePathBinding(bindingCtx, _path);\n    var router = ref[0];\n    var path = ref[1];\n    return router.base + path;\n}\n\nfunction isActivePath(bindingCtx, _path) {\n    var ref = parsePathBinding(bindingCtx, _path);\n    var router = ref[0];\n    var path = ref[1];\n    return !router.isNavigating() && (router.ctx.pathname || '/') === '/' + path.split('/')[1];\n}\n\nfunction parsePathBinding(bindingCtx, path) {\n    var router = getRouter(bindingCtx);\n    if (path.indexOf('//') === 0) {\n        path = path.replace('//', '/');\n        while (!router.isRoot) {\n            router = router.$parent;\n        }\n    } else {\n        if (path.indexOf('./') === 0) {\n            path = path.replace('./', '/');\n            router = router.$child;\n        }\n        while (path && path.match(/\\/?\\.\\./i) && !router.isRoot) {\n            router = router.$parent;\n            path = path.replace(/\\/?\\.\\./i, '');\n        }\n    }\n    return [router,path];\n}\n\nfunction getRouter(bindingCtx) {\n    while (!isUndefined(bindingCtx)) {\n        if (!isUndefined(bindingCtx.$router)) {\n            return bindingCtx.$router;\n        }\n        bindingCtx = bindingCtx.$parentContext;\n    }\n    return Router$1.get(0);\n}\n\nko.components.register('ko-component-router', {\n    synchronous: true,\n    viewModel: {\n        createViewModel: function (params) { return new Router$1(unwrapParams(params)); }\n    },\n    template: \"<div data-bind=\\\"if: component\\\">\\n      <div class=\\\"ko-component-router-view\\\" data-bind=\\\"__ko_component_router__\\\"></div>\\n    </div>\"\n});\nko.bindingHandlers.__ko_component_router__ = {\n    init: function init(el, valueAccessor, allBindings, viewModel, bindingCtx) {\n        var $router = bindingCtx.$rawData;\n        ko.applyBindingsToNode(el, {\n            css: $router.component,\n            component: {\n                name: $router.component,\n                params: $router.ctx\n            }\n        }, bindingCtx.extend({\n            $router: $router\n        }));\n        return {\n            controlsDescendantBindings: true\n        };\n    }\n};\nfunction unwrapParams(params) {\n    function unwrapParam(p) {\n        if (ko.isObservable(params[p])) {\n            console.warn((\"\\n        [ko-component-router] `params.\" + p + \"` was passed in as an observable.\\n        It willbe unwrapped, but changes will NOT be observed.\\n    \"));\n            params[p] = ko.unwrap(params[p]);\n        }\n    }\n    \n    unwrapParam('routes');\n    unwrapParam('base');\n    unwrapParam('hashbang');\n    return params;\n}\n\nreturn Router$1;\n\n})));\n"]}